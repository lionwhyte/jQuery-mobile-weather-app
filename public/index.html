<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/jquery.mobile-1.4.5.css">
    <script src = "./js/jquery.js"></script>
    <script src = "./js/jquery.mobile-1.4.5.js"></script>

    <style>
        body{
            position: relative;
        }

        .footer-button-left,
        .footer-button-right {
            position: absolute;
            margin: 0;
            top: auto;
            bottom: 0.24em;
        }
      
        .footer-button-left {
            left: 0.4em;
        }
      
        .footer-button-right {
            right: 0.4em;
        }

        #main {
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        img{
            width: 25%;
            height: 25%;
        }

        span{
            font-size: 14px;
            font-weight: bolder;
            margin-left: 0.5ch;
        }

        .infoDiv{
            display: flex;
            flex-direction: row;
            align-items: center;
            margin: 3% 0 3%;
        }

        #loading{
            position: absolute;
            top: 50%;
            left: 50%;
            -ms-transform: translate(-50%, -50%);
            transform: translate(-50%, -50%);
            z-index: 1;
            width: 10ch;
            height: 10ch;
            display: none;
        }
    </style>
    
</head>
<body>
    
    <img src="./img/loading.gif" id="loading">

    <!-- Start of first page -->
    <div data-role="page" id="main" style="background-image: url(./img/clouds.jpg); background-size: cover; background-position: center;">

        <div data-role="header" data-position="fixed" data-theme = "b" style="background-color: #008fff;">
            <h1>Weather App</h1>
            <a href = "#menu_panel" class = "ui-btn ui-corner-all ui-btn-inline ui-mini 
            footer-button-left ui-btn-icon-left ui-icon-bars">Menu</a>
         <a href = "#options_panel" class = "ui-btn ui-corner-all ui-btn-inline ui-mini 
            footer-button-right ui-btn-icon-right ui-icon-gear">Options</a>
        </div><!-- /header -->
    
        <div role="main" class="ui-content">
            <form id="form">
                <input type="search" id="search" name="search" placeholder="Search weather..." style="padding: 8px 0 8px 28px;">
                <!-- <input type="submit" value="Search"> -->
            </form> 
        </div><!-- /content -->

        <div role="main" class="ui-content" >
            <div class="ui-grid-a" style="display: flex; align-items: center; margin-bottom: 16px;">
                <div class="ui-block-a" style="display: flex; flex-direction: column;">
                    <h2 style="margin: 0;" id="place"></h2>
                    <p style="margin: 0 0 8px;" id="countryN"></p>
                    <div style="margin: 0;" id="weather">     
                        <h4 id="weatherDesc" style="margin: 0;"></h4>                       
                    </div>
                  
                </div>
                <div class="ui-block-b" style="text-align: center;">
                    <h1 style="font-weight: lighter; font-size: 64px; margin: 0;" id="temp"></h1>
                </div> 
            </div>
          
            <div role="main" class="ui-content ui-corner-all ui-grid-b" style="background-color: #ffffff; padding: 0 16px 0 16px;">
                <div class = "ui-block-a infoDiv">
                    <img src="./img/humidity.png"><span id="humidity"></span>
                </div>
                <div class = "ui-block-b infoDiv">
                    <img src="./img/precip.png"><span id="precip"></span>
                </div>
                <div class = "ui-block-c infoDiv">
                    <img src="./img/pressure.png"><span id="pressure"></span>
                </div>
                <div class = "ui-block-a infoDiv">
                    <img src="./img/wind-speed.png"><span id="windSpeed"></span>
                </div>
                <div class = "ui-block-b infoDiv">
                    <img src="./img/wind-direction.png"><span id="windDir"></span>
                </div>  
            </div>
        </div>   
     

        <div data-role = "panel" id = "menu_panel" data-display = "overlay" data-theme = "b">
            <ul data-role = "listview">
                <li data-icon = "delete"><a href = "#" data-rel = "close">Close</a></li>
            </ul>
            <div data-role = "main" class = "ui-content">
                <a href = "#about" data-rel = "popup" data-position-to = "window" 
                data-transition = "pop" class = "ui-btn ui-icon-info 
                ui-btn-icon-left ui-btn-b ui-btn ui-corner-all">About</a>
                <a href = "#help" data-rel = "popup" data-position-to = "window" 
               data-transition = "pop" class = "ui-btn ui-icon-info 
               ui-btn-icon-left ui-btn-b ui-btn ui-corner-all">Help</a>
            </div>   
        </div>

        <div data-role = "panel" id = "options_panel" data-position = "right" 
            data-display = "overlay" data-theme = "b">
            <ul data-role = "listview" style="margin-bottom: 8px;">
               <li data-icon = "delete"><a href = "#" data-rel = "close">Close</a></li>
            </ul>
            <form>
                <h4>Choose Unit Of Temperature:</h4>
                <fieldset data-role = "controlgroup">
                   <input type = "radio" id = "radio1" name = "radio-choice-0" checked = "checked" />
                   <label for = "radio1">Celsius</label>
       
                   <input type = "radio" id = "radio2" name = "radio-choice-0" />
                   <label for = "radio2">Fahrenheit</label>
                </fieldset>
            </form>
            <div data-role = "popup" id = "about" data-theme = "b" data-dismissible = "false">
                <div role = "main" class = "ui-content">
                    <h4 class = "ui-title">This is my first mobile app using jQuery Mobile library and Weatherstack API</h4>
                    <a href = "#" class = "ui-btn ui-btn-inline ui-btn-b" data-rel = "back">
                    Close</a>
                </div>
            </div>
        </div>

        <div data-role = "popup" id = "help" data-theme = "b" data-dismissible = "false">
            <div role = "main" class = "ui-content">
                <h4 class = "ui-title">Type location like city/town/region or coordinates lat,long(e.g. 45,15)</h4>
                <a href = "#" class = "ui-btn ui-btn-inline ui-btn-b" data-rel = "back">
                Close</a>
            </div>
        </div>
    </div>

    
    <script>
        $(document).ready(function(){
            let unit = "m"
            let unitTxt = "C°"
            let windS = "km/h"
            $("#radio1").click(function () {  
            unit = "m"
            unitTxt = "C°"
            windS = "km/h"
            });
            $("#radio2").click(function () {  
                unit = "f"
                unitTxt = "F°"
                windS = "mp/h"
            });
            $("#form").submit(function (e) {  
                e.preventDefault()
                $("#loading").show();
                $.get("http://api.weatherstack.com/current?access_key=52db9c667bb8894018d6932506f9419c&query=" + search.value + "&units=" + unit, function(data, status){
                    $("#loading").hide();    
                    $("#place").text(data.location.name);
                    $("#countryN").text(data.location.country);
                    $("#weather").html("<img src=" + data.current.weather_icons[0] + ">" + "<br>" + "<b>" + 
                    data.current.weather_descriptions[0] + "</b>");
                    $("#temp").text(data.current.temperature + " " + unitTxt);
                    $("#humidity").text(data.current.humidity + " %");
                    $("#precip").text(data.current.precip + " mm");
                    $("#pressure").text(data.current.pressure + " hpa");
                    $("#windSpeed").text(data.current.wind_speed + " " + windS);
                    $("#windDir").text(data.current.wind_dir);
                });
            });
        });
       
    </script>
</body>
</html>